# Задание 6

| Параметр            | Условие   |
|---------------------|-----------|
| Ограничение времени | 3 секунды |
| Ограничение памяти  | 256 MB    |

Поздравляю, вы дошли до серьёзной задачи, больше никаких легенд, только хардкор.

Дан массив _**a**_ из _**n**_ целых чисел. Требуется выполнить _**q**_ запросов такого вида
 (1 ≤ _**l**_ ≤ _**r**_ ≤ **n**, 0 ≤ _**k**_, _**b**_, _**x**_ ≤ 10<sup>9</sup>):

- _**+ l r x**_ — прибавить _**x**_ ко всем _**a<sub>i</sub>**_ на отрезке _**i**_ ∈ [_**l**_, _**r**_]

- _**? l r k b**_ — вывести _**max<sub>l ≤ i ≤ r</sub>min(a<sub>i</sub>, k ⋅ i + b)**_

### Формат входных данных

В первой строке заданы два числа _**n**_ и _**q**_ 
(1 ≤ _**n**_ ≤ 2⋅10<sup>5</sup>, 1 ≤ _**q**_ ≤ 5⋅10<sup>5</sup>).

Во второй строке задан массив _**a**_ (0 ≤ a<sub>i</sub> ≤ 10<sup>9</sup>).

Следующие _**q**_ строк содержат запросы в заданном формате. 
Гарантируется, что будет хотя бы один запрос типа **?**.

### Формат выходных данных

Для каждого запроса типа **?** выведите ответ в отдельной строке.

## Примеры данных

```input
6 3
2 4 6 8 10 12
? 2 5 3 0
+ 2 3 6
? 2 5 3 2
```

```output
10
11
```
## [Решение](Program.cs)